<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>multiversum - some hours of tooling</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
    </head>
    <body class="font-personal">
        <div id="header">
            <div id="logo">
                <a href="../">multiversum</a>
            </div>
            <div id="navigation">
                <a href="../about.html">about</a>
                <a href="../time.html">log</a>
                <a href="../reitera.html">reitera</a>
                <a href="../contact.html">contact</a>
            </div>
        </div>

        <div id="content">
            <h1>some hours of tooling</h1>

            <div class="info">
    Posted on March 31, 2017
    
</div>

<p>I have to update the Haskell compiler. I anticipate a few hours of boring struggling with my system and itâ€™s tooling. Writing can help me to reap some learning out of the experience and improve my process. I donâ€™t expect anyone to find this interesting.</p>
<p>My compiler is installed via Nix:</p>
<pre><code> ~ $ which ghc
/home/francesco/.nix-profile/bin/ghc</code></pre>
<p>I donâ€™t expect Nix to provide the most recent version, but the update commands are simple so i might as well run them. Luckily i took a note about how to do that.</p>
<pre><code> ~ $ nix-env --upgrade haskellPackages.ghc
error: cannot coerce a set to a string, at /nix/store/4h2xc7xql5p8rg0fmq69bxmc1bgfqkwi-nixpkgs-17.09pre104746.3d5e451/nixpkgs/pkgs/development/interpreters/ruby/default.nix:57:17</code></pre>
<p>The upgrade command fails with an error which seems related to interpreting something via Ruby. I shouldnâ€™t be having anything to do with Ruby for a task like this. Also, Nix is being unstable on updates, which is the main features i expect from it. I will try to just ditch Nix for Haskell. The only reason i use Nix with Haskell is to expose a binding to the Z compression library, but hopefully with a more recent version of the compiler, that wonâ€™t be needed anymore.</p>
<p>Removing the version of the compiler provided by Nix would make troubleshooting easier, but iâ€™m not sure that ditching Nix is going to be the best decision in the end, so i will try to install a new compiler and use it side by side with the one provided by Nix.</p>
<p>Now, the problem is not the compiler in itself but the Cabal system, because of the shared status represented by the installed packages, and the interactions wyth the operative system via the system libraries.</p>
<pre><code> ~ $ which cabal
/home/francesco/.nix-profile/bin/cabal</code></pre>
<p>Also Cabal is provided by Nix.</p>
<h4 id="enter-stack">Enter Stack</h4>
<p>Stack actually has been designed in order to solve all of these problems. Letâ€™s give it a try.</p>
<h4 id="fixed">Fixed</h4>
<p>Using Stack, without changing anything in my system, i can cleanly replicate exactly the same failure Hackage is producing when trying to build my package. Iâ€™m all sorted. The boring hours of system fixing were avoided by simply using Stack! ðŸ˜Š</p>
<h4 id="now-the-haskell-part">Now the Haskell part</h4>
<p>I still have to fix a problem with dependencies that i donâ€™t understand clearly â€¦ that can take a boring while.</p>

        </div>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
